<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>배너 횡이동 심화</title>
    <link rel="stylesheet" href="../../css/reset.css">
    <style>
        
        div#bannerBox{
            overflow: hidden;
            position:relative;
            margin:100px auto;
            width:800px; /*커지는 애니메이션으로 새롭게 추가작성*/
            height:150px;
            border:3px solid red;
        }
        div#bannerBox>ul#bannerList{
            display:flex;
            position:absolute;
            left:0; top:0;
             
            height:150px; /*커지는 애니메이션으로 새롭게 추가작성*/
        }
        div#bannerBox>ul#bannerList>li{
            flex:1 1 auto;
            width:200px; /*커지는 애니메이션으로 새롭게 추가작성*/
            height:50px; /*커지는 애니메이션으로 새롭게 추가작성*/
            transition:all 1s ease; /*커지는 애니메이션으로 새롭게 추가작성*/
        }
        div#bannerBox>ul#bannerList>li.on{ /*커지는 애니메이션으로 새롭게 추가작성*/
            width:400px; 
            height:150px;
        }

        div#bannerBox>ul#bannerList>li.first{background:hotpink;}
        div#bannerBox>ul#bannerList>li.second{background:rgb(42, 107, 109);}
        div#bannerBox>ul#bannerList>li.third{background:rgb(22, 58, 75);}
        div#bannerBox>ul#bannerList>li.fourth{background:rgb(99, 189, 126);}
        div#bannerBox>ul#bannerList>li.fifth{background:rgb(255, 203, 105);}
        div#bannerBox>ul#bannerList>li.six{background:rgb(65, 57, 43);}
        
        p.btnPrev{
            margin-left:50px;
        }
        p.btnNext{
            margin-left:50px;
        }

        ul.bullet{
            margin-left:50px;
        }
        ul.bullet>li{}
        ul.bullet>li.on{
            background:red;
            color:#fff;
        }

    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(function(){
            var banner = {
                w:200, //li 각각 width 커지는 애니메이션으로 새롭게 추가작성
                expW:200,  //li width값에 확장되는 수치 커지는 애니메이션으로 새롭게 추가작성
                idx:1,
                len: $("#bannerList").children().length,
                // auto:setInterval(middleFn,1000)
                

            }
            
            function middleFn(){
                banner.idx++; 

                if(banner.idx >= banner.len){

                    banner.idx = 0;  

                }
                doBullet();
                doNext();
            }
            //ul의 크기 자식의 개수 x width + 확장크기
            $("#bannerList")
            .css("width",(banner.len*banner.w+banner.expW)+"px");

            for(var i =0; i<banner.len; i++){
                if(i==0){
                    $(".bullet").append($("<li class='on'>"+(i+1)+"</li>"));
                }else{
                    
                    $(".bullet").append($("<li>"+(i+1)+"</li>"));

                }
                
            };

            $(".btnNext").click(function(){
                //clearInterval(banner.auto);
                middleFn();
                //banner.auto = setInterval(middleFn,3000);
            });

            $(".btnPrev").click(function(){
                //clearInterval(banner.auto);
                banner.idx--;
                if(banner.idx < 0){

                    banner.idx = banner.len - 1;  

                }

                
                doBullet();
                doPrev();
                //banner.auto = setInterval(middleFn,3000);
                
            });

            $(".bullet").children("li").click(function(){
                //clearInterval(banner.auto);
                var now_idx = $(this).index();
                
                //뺀만큼 이동시키기 위한 빼기 연산 현재 클릭한 번호를 지정한 번호에서 빼기
                var dir_Count = now_idx - banner.idx;
                
                if(dir_Count>0){//뺀수가 양수이면 next

                    for(var k=0; k<dir_Count; k++){
                        doNext();
                        
                    }
                }else{//뺀수가 음수이면 prev
                    dir_Count *= -1; //음수를 양수로 변환 
                    for(var k=0; k<dir_Count; k++){
                        doPrev();
                        
                    }
                }
                banner.idx = now_idx;
                doBullet();
                //banner.auto = setInterval(middleFn,3000);
            });

            function doBullet(){
                $(".bullet").children("li")
                .eq(banner.idx).addClass("on")
                .siblings().removeClass("on");
            }

            function doNext(){
               
                $("#bannerList").stop(true,true).animate({"left":-banner.w},1000
                ,function(){
                    var _this = $(this);

                    $("#bannerList").children().first().appendTo(_this);
                    _this.css("left",0);

                    
                });//애니메이션 끝

                //커지는 애니메이션으로 새롭게 추가작성
                $("#bannerList").children("li.on")
                .next().addClass("on")
                .siblings().removeClass("on");
            }

            function doPrev(){
                var bannerUl = $("#bannerList");
                bannerUl.children().last().prependTo(bannerUl);
                bannerUl.css("left",-banner.w);
                bannerUl.stop(false,false).animate({"left":0},1000);
                //애니메이션 끝

                //커지는 애니메이션으로 새롭게 추가작성
                $("#bannerList").children("li.on")
                .prev().addClass("on")
                .siblings().removeClass("on");
            }

         });//전체 함수 끝

    </script>

</head>
<body>
    <div id="bannerBox">
        <ul id="bannerList">
            <li class="first">1번 배너</li>
            <li class="second on">2번 배너</li>
            <li class="third">3번 배너</li>
            <li class="fourth">4번 배너</li>
            <li class="fifth">5번 배너</li>
            <li class="six">6번 배너</li>
        </ul>
    </div>
    <p class="btnPrev">이전</p>
    <p class="btnNext">다음</p>
    <ul class="bullet">
        
    </ul>
</body>
</html>